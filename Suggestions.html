<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>ESoSearch</title>

    <link rel="stylesheet" type="text/css" media="screen and (max-width: 768px)" href="portrait.css">
    <link rel="stylesheet" type="text/css" media="screen and (min-width: 769px)" href="desktop.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <script type="text/javascript" src="./src/ESoSearch.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
    <div class="wrapper">
        <div id="result-cards">
            <h1 id="suggestions-results">Our Suggestions</h1><br>
            <div class="center-but">
                <button type="button" class="btn btn-primary" name="customize" id="customize-but" data-toggle="modal"
                    data-target="#customize-modal">Customize</button>
            </div>
            <br>
            <label class="category-title">Top Animal/Pets Events</label>
            <div class="result-card" id="result0">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
            <div class="result-card" id="result1">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
            <label class="category-title">Top Museum and Attraction Events</label>
            <div class="result-card" id="result2">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
            <div class="result-card" id="result3">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
            <label class="category-title">Top Food Events</label>
            <div class="result-card" id="result4">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
            <div class="result-card" id="result5">
                <h4 class="title"></h4>
                <p class="description">
                </p>
            </div>
        </div>
    </div>

    <div id="customize-modal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Please choose:</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>

                </div>
                <div class="modal-body">
                    <div class="options">
                        <h6>Activity:</h6>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample1"
                                name="activity-option" value="comedy" checked>
                            <label class="form-check-label" for="materialGroupExample1">Comedy</label>
                        </div>

                        <!-- Group of material radios - option 2 -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample2"
                                name="activity-option" value="clubs_associations">
                            <label class="form-check-label" for="materialGroupExample2">Clubs and Meetups</label>
                        </div>

                        <!-- Group of material radios - option 3 -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample3"
                                name="activity-option" value="art">
                            <label class="form-check-label" for="materialGroupExample3">Art</label>
                        </div>

                        <!-- Group of material radios - option 3 -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample4"
                                name="activity-option" value="support">
                            <label class="form-check-label" for="materialGroupExample4">Health, Fitness &
                                Wellness</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample5"
                                name="activity-option" value="outdoors_recreation">
                            <label class="form-check-label" for="materialGroupExample5">Outdoors & recreation</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample6"
                                name="activity-option" value="animals">
                            <label class="form-check-label" for="materialGroupExample6">Pets and Animals</label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="activity-option"
                                value="religion_spirituality">
                            <label class="form-check-label">Religion & Spirituality</label>
                        </div>

                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="activity-option"
                                value="learning_education">
                            <label class="form-check-label">Educational</label>
                        </div>

                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="activity-option" value="food">
                            <label class="form-check-label">Food</label>
                        </div>

                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="activity-option"
                                value="politics_activism">
                            <label class="form-check-label">Politics & Activism</label>
                        </div>

                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="activity-option" value="fundraisers">
                            <label class="form-check-label">Fundraising & Charity</label>
                        </div>

                    </div>
                    <div class="options">
                        <!--///////////-->
                        <h6>Type:</h6>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="type-option" value="inperson" checked>
                            <label class="form-check-label">In-person</label>
                        </div>
                        <!-- Group of material radios - option 2 -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="type-option" value="online">
                            <label class="form-check-label">Online</label>
                        </div>
                    </div>

                    <!--///////////-->
                    <div class="options">
                        <h6>Location:</h6>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample1"
                                name="location-option" value="nearby" checked>
                            <label class="form-check-label" for="materialGroupExample1">My Area</label>
                        </div>

                        <!-- Group of material radios - option 2 -->
                        <div class="form-check">
                            <input type="radio" class="form-check-input" id="materialGroupExample2"
                                name="location-option" value="anywhere">
                            <label class="form-check-label" for="materialGroupExample2">Anywhere</label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer wrapper">
                    <!--<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>-->
                    <div class="wrapper-but">

                        <button type="button" class="btn btn-secondary" name="suggestions" id="cancel-but"
                            data-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" name="search" id="search-but">Search</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</body>

</html>

<script>
    var userLocation = {
        "userLatitude": 0.0,
        "userLongitude": 0.0
    };
    getUserGeoLocation();

    $(".result-card").hover(function () {
        $(this).css("box-shadow", "0 6px 20px 0 rgba(0, 0, 0, 0.19)");
    });

    $(".result-card").mouseleave(function () {
        $(this).css("box-shadow", "0 4px 8px 0 rgba(0, 0, 0, 0.2)");
    });

    function getUserGeoLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                // console.log(position.coords.latitude);
                userLocation["userLatitude"] = position.coords.latitude;
                userLocation["userLongitude"] = position.coords.longitude;
            })
        }
        else {
            console.log("Geolocation is not supported");
        }
        loadTopEvents();
    }

    function loadTopEvents() {
        fetch('http://api.eventful.com/json/events/search?&category=animals&location=Chicago&date=Future&app_key=5dVs5WSgZ5GQ9smS')
            .then(res => res.json())
            .then(data => {
                events = data['events']['event'];
                console.log(events);
                var index = 0;
                for (var i in events) {
                    // console.log(events[i]['description']);
                    if (index > 1) {
                        break;
                    }
                    if (events[i]['description'] == null) {
                        events[i]['description'] = "No Description Available. Click on this event to see more details";
                    }
                    if (document.getElementById("result" + index) != null) {
                        card_elements = document.getElementById("result" + index).children;
                        card_elements[0].innerHTML = events[i]['title'];
                        card_elements[1].innerHTML = events[i]['description'];

                        var urlTag = document.createElement('a');
                        urlTag.setAttribute('href', events[i]['url']);
                        urlTag.setAttribute('class', "stretched-link");
                        urlTag.setAttribute('target', '_blank');
                        document.getElementById("result" + index).appendChild(urlTag);
                        index++;
                    }
                }
            })
        fetch('http://api.eventful.com/json/events/search?&category=attractions&location=Chicago&date=Future&app_key=5dVs5WSgZ5GQ9smS')
            .then(res => res.json())
            .then(data => {
                events = data['events']['event'];
                console.log(events);
                var index = 2;
                for (var i in events) {
                    // console.log(events[i]['description']);
                    if (index > 3) {
                        break;
                    }
                    if (events[i]['description'] == null) {
                        events[i]['description'] = "No Description Available. Click on this event to see more details";
                    }
                    if (document.getElementById("result" + index) != null) {
                        card_elements = document.getElementById("result" + index).children;
                        card_elements[0].innerHTML = events[i]['title'];
                        card_elements[1].innerHTML = events[i]['description'];

                        var urlTag = document.createElement('a');
                        urlTag.setAttribute('href', events[i]['url']);
                        urlTag.setAttribute('class', "stretched-link")
                        document.getElementById("result" + index).appendChild(urlTag);
                        index++;
                    }
                }
            })
        fetch('http://api.eventful.com/json/events/search?&category=food&location=Chicago&date=Future&app_key=5dVs5WSgZ5GQ9smS')
            .then(res => res.json())
            .then(data => {
                events = data['events']['event'];
                console.log(events);
                var index = 4;
                for (var i in events) {
                    // console.log(events[i]['description']);
                    if (index > 5) {
                        break;
                    }
                    if (events[i]['description'] == null) {
                        events[i]['description'] = "No Description Available. Click on this event to see more details";
                    }
                    if (document.getElementById("result" + index) != null) {
                        card_elements = document.getElementById("result" + index).children;
                        card_elements[0].innerHTML = events[i]['title'];
                        card_elements[1].innerHTML = events[i]['description'];

                        var urlTag = document.createElement('a');
                        urlTag.setAttribute('href', events[i]['url']);
                        urlTag.setAttribute('class', "stretched-link")
                        document.getElementById("result" + index).appendChild(urlTag);
                        index++;
                    }
                }
            })
    }

    $("#search-but").click(function () {
        const activityOptions = document.querySelectorAll('input[name="activity-option"]');
        let selectedActivity;
        for (const aOption of activityOptions) {
            if (aOption.checked) {
                selectedActivity = aOption.value;
                break;
            }
        }

        const locationOptions = document.querySelectorAll('input[name="location-option"]');
        let selectedLocation;
        for (const lOption of locationOptions) {
            if (lOption.checked) {
                selectedLocation = lOption.value;
                break;
            }
        }

        const typeOptions = document.querySelectorAll('input[name="type-option"]');
        let selectedType;
        for (const tOption of typeOptions) {
            if (tOption.checked) {
                selectedType = tOption.value;
                break;
            }
        }

        // window.location.href = "./Results.html?activity=" + selectedActivity + "&type=" + selectedType + "&location=" + selectedLocation;
    });
</script>